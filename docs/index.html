<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>mud3</title><meta name="description" content="Documentation for mud3"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">mud3</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>mud3</h1></div><div class="tsd-panel tsd-typography"><h1 id="mud3-packages-guide" class="tsd-anchor-link">mud3 packages guide<a href="#mud3-packages-guide" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This document covers the built-in packages under <code>src/package/</code> and shows how to use them together in your MUD server.</p>
<ul>
<li>Package loader target: each module exports a default object <code>{ name, loader, dependencies }</code> for composition with a package loader.
<ul>
<li><code>name: string</code> — unique package identifier</li>
<li><code>loader: () =&gt; Promise&lt;void&gt;</code> — async initializer</li>
<li><code>dependencies?: Package[]</code> — optional array of other package objects (their default exports) that must be loaded first</li>
</ul>
</li>
<li>Standalone APIs: many packages also export helper functions or data for direct use.</li>
</ul>
<h2 id="quick-start-running-loaders" class="tsd-anchor-link">Quick start: running loaders<a href="#quick-start-running-loaders" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="ts"><span class="hl-0">// app.ts (TypeScript / ESM)</span><br/><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">loadPackage</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;package-loader&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">commands</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/commands.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">config</span><span class="hl-2">, { </span><span class="hl-3">CONFIG</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/config.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">lockfile</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/lockfile.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">character</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/character.ts&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Run packages in a simple sequence (recommended)</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">lockfile</span><span class="hl-2">);   </span><span class="hl-0">// ensure single instance</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">config</span><span class="hl-2">);     </span><span class="hl-0">// load config.yaml (creates default if missing)</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">commands</span><span class="hl-2">);   </span><span class="hl-0">// load commands from data/commands/ and src/commands/</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">character</span><span class="hl-2">);  </span><span class="hl-0">// prepare character storage directory</span><br/><br/><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">&#39;Server port:&#39;</span><span class="hl-2">, </span><span class="hl-6">CONFIG</span><span class="hl-2">.</span><span class="hl-3">server</span><span class="hl-2">.</span><span class="hl-3">port</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<p>If you prefer dynamic discovery, you can wire these into your package loader of choice; each export conforms to <code>{ name: string, loader: () =&gt; Promise&lt;void&gt;, dependencies?: Package[] }</code>.</p>
<p>Note: Outside of tests, do not call <code>pkg.loader()</code> directly. Always use <code>loadPackage(pkg)</code> so ordering, errors, and lifecycle are handled consistently.</p>
<hr>
<h2 id="package" class="tsd-anchor-link">package<a href="#package" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="commands" class="tsd-anchor-link">commands<a href="#commands" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Loads command modules from two locations at startup:</p>
<ul>
<li><code>data/commands</code> (runtime-extensible JS commands)</li>
<li><code>dist/src/commands</code> (compiled built-in commands)</li>
</ul>
<p>Only <code>.js</code> files are loaded; files beginning with <code>_</code> are ignored. The loader logs progress and registers commands into <code>CommandRegistry.default</code>.</p>
<h4 id="command-shape" class="tsd-anchor-link">Command shape<a href="#command-shape" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Each command module should export a default plain object:</p>
<pre><code class="js"><span class="hl-0">// data/commands/say.js</span><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-1">default</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">pattern:</span><span class="hl-2"> </span><span class="hl-4">&#39;say &lt;...text:any&gt;&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">aliases:</span><span class="hl-2"> [</span><span class="hl-4">&#39;&quot;&#39;</span><span class="hl-2">],</span><br/><span class="hl-2">  </span><span class="hl-5">execute</span><span class="hl-2">(</span><span class="hl-3">ctx</span><span class="hl-2">, </span><span class="hl-3">args</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-7">const</span><span class="hl-2"> </span><span class="hl-6">text</span><span class="hl-2"> = </span><span class="hl-3">args</span><span class="hl-2">.</span><span class="hl-5">get</span><span class="hl-2">(</span><span class="hl-4">&#39;text&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-3">ctx</span><span class="hl-2">.</span><span class="hl-3">client</span><span class="hl-2">.</span><span class="hl-5">sendLine</span><span class="hl-2">(</span><span class="hl-3">text</span><span class="hl-2">);</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-5">onError</span><span class="hl-2">(</span><span class="hl-3">ctx</span><span class="hl-2">, </span><span class="hl-3">result</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-3">ctx</span><span class="hl-2">.</span><span class="hl-3">client</span><span class="hl-2">.</span><span class="hl-5">sendLine</span><span class="hl-2">(</span><span class="hl-3">result</span><span class="hl-2">.</span><span class="hl-3">error</span><span class="hl-2"> ?? </span><span class="hl-4">&#39;Could not parse command&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<h4 id="using-the-loader-via-package-loader" class="tsd-anchor-link">Using the loader (via package-loader)<a href="#using-the-loader-via-package-loader" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="ts"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">loadPackage</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;package-loader&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">commands</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/commands.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">commands</span><span class="hl-2">);</span><br/><span class="hl-0">// Commands are now registered with CommandRegistry.default</span>
</code><button type="button">Copy</button></pre>

<p>Directory conventions:</p>
<ul>
<li>Put custom runtime commands in <code>data/commands/*.js</code></li>
<li>Built-in commands live in <code>src/commands/*.ts</code></li>
</ul>
<hr>
<h3 id="config" class="tsd-anchor-link">config<a href="#config" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><h4 id="yaml-configuration-loader" class="tsd-anchor-link">YAML configuration loader<a href="#yaml-configuration-loader" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Loads <code>data/config.yaml</code> and merges it into a typed in-memory <code>CONFIG</code> object. If the file is absent or unreadable, a default is written to disk.</p>
<h4 id="shapes" class="tsd-anchor-link">Shapes<a href="#shapes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="ts"><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-7">type</span><span class="hl-2"> </span><span class="hl-8">GameConfig</span><span class="hl-2"> = { </span><span class="hl-3">name</span><span class="hl-2">: </span><span class="hl-8">string</span><span class="hl-2">; </span><span class="hl-3">creator</span><span class="hl-2">: </span><span class="hl-8">string</span><span class="hl-2"> };</span><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-7">type</span><span class="hl-2"> </span><span class="hl-8">ServerConfig</span><span class="hl-2"> = { </span><span class="hl-3">port</span><span class="hl-2">: </span><span class="hl-8">number</span><span class="hl-2">; </span><span class="hl-3">inactivity_timeout</span><span class="hl-2">: </span><span class="hl-8">number</span><span class="hl-2"> };</span><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-7">type</span><span class="hl-2"> </span><span class="hl-8">SecurityConfig</span><span class="hl-2"> = { </span><span class="hl-3">password_salt</span><span class="hl-2">: </span><span class="hl-8">string</span><span class="hl-2"> };</span><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-7">type</span><span class="hl-2"> </span><span class="hl-8">Config</span><span class="hl-2"> = {</span><br/><span class="hl-2">  </span><span class="hl-3">game</span><span class="hl-2">: </span><span class="hl-8">GameConfig</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-3">server</span><span class="hl-2">: </span><span class="hl-8">ServerConfig</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-3">security</span><span class="hl-2">: </span><span class="hl-8">SecurityConfig</span><span class="hl-2">;</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<h4 id="defaults-and-usage" class="tsd-anchor-link">Defaults and usage<a href="#defaults-and-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="ts"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">configPkg</span><span class="hl-2">, { </span><span class="hl-3">CONFIG</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/config.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">configPkg</span><span class="hl-2">);</span><br/><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-6">CONFIG</span><span class="hl-2">.</span><span class="hl-3">server</span><span class="hl-2">.</span><span class="hl-3">port</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<p>Example <code>data/config.yaml</code> you can customize:</p>
<pre><code class="yaml"><span class="hl-9">game</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-9">name</span><span class="hl-2">: </span><span class="hl-10">mud3</span><br/><span class="hl-2">  </span><span class="hl-9">creator</span><span class="hl-2">: </span><span class="hl-10">jackindisguise</span><br/><span class="hl-9">server</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-9">port</span><span class="hl-2">: </span><span class="hl-11">23</span><br/><span class="hl-2">  </span><span class="hl-9">inactivity_timeout</span><span class="hl-2">: </span><span class="hl-11">1800</span><br/><span class="hl-9">security</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-9">password_salt</span><span class="hl-2">: </span><span class="hl-10">changeme_default_salt_12345</span>
</code><button type="button">Copy</button></pre>

<p>Notes:</p>
<ul>
<li>Only known keys are merged; unknown keys are ignored.</li>
<li>The loader logs which values come from defaults vs overrides.</li>
</ul>
<hr>
<h3 id="lockfile-single-instance-process-lock" class="tsd-anchor-link">lockfile (single-instance process lock)<a href="#lockfile-single-instance-process-lock" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Ensures only one instance of the app runs by managing a <code>.lock</code> file in the project root. On startup the loader checks for an existing lock and whether the process associated with it is alive, removing stale locks automatically. It creates and cleans up the lock on exit.</p>
<h4 id="using-the-loader-via-package-loader-1" class="tsd-anchor-link">Using the loader (via package-loader)<a href="#using-the-loader-via-package-loader-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="ts"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">loadPackage</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;package-loader&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">lockfile</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/lockfile.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">lockfile</span><span class="hl-2">);</span><br/><span class="hl-0">// Exits the process if another instance is running</span>
</code><button type="button">Copy</button></pre>

<h4 id="standalone-utilities" class="tsd-anchor-link">Standalone utilities<a href="#standalone-utilities" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>You can also use helpers directly:</p>
<pre><code class="ts"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">isProcessRunning</span><span class="hl-2">, </span><span class="hl-3">createLock</span><span class="hl-2">, </span><span class="hl-3">removeLock</span><span class="hl-2">, </span><span class="hl-3">checkLock</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/lockfile.ts&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">if</span><span class="hl-2"> (</span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">checkLock</span><span class="hl-2">()) </span><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-5">exit</span><span class="hl-2">(</span><span class="hl-11">1</span><span class="hl-2">);</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">createLock</span><span class="hl-2">();</span><br/><span class="hl-0">// ... later</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">removeLock</span><span class="hl-2">();</span>
</code><button type="button">Copy</button></pre>

<hr>
<h3 id="character" class="tsd-anchor-link">character<a href="#character" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Persists <code>Character</code> entities to <code>data/characters/&lt;username&gt;.yaml</code> and restores them back using <code>Character.serialize()</code>/<code>character.deserialize()</code>.</p>
<ul>
<li>Filenames are derived from a sanitized, lowercased username.</li>
<li>On save, directories are created as needed; YAML is written without references and with a wide line width for readability.</li>
<li>On load, returns <code>undefined</code> if the file doesn’t exist.</li>
</ul>
<p>Active character registry (local lock): this package maintains a registry of usernames that are currently active. <code>loadCharacter()</code> refuses to load a character that’s already active and automatically registers loaded characters. The game calls <code>unregisterActiveCharacter(username)</code> on disconnect.</p>
<h3 id="api-and-usage" class="tsd-anchor-link">API and usage<a href="#api-and-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Example of declaring dependencies between packages:</p>
<pre><code class="ts"><span class="hl-0">// src/package/world.ts</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-1">type</span><span class="hl-2"> { </span><span class="hl-3">Package</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;package-loader&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">config</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./config.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">character</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./character.ts&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-1">default</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">name:</span><span class="hl-2"> </span><span class="hl-4">&#39;world&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">dependencies:</span><span class="hl-2"> [</span><span class="hl-3">config</span><span class="hl-2">, </span><span class="hl-3">character</span><span class="hl-2">], </span><span class="hl-0">// depends on config and character being loaded first</span><br/><span class="hl-2">  </span><span class="hl-5">loader</span><span class="hl-3">:</span><span class="hl-2"> </span><span class="hl-7">async</span><span class="hl-2"> () </span><span class="hl-7">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// initialization that requires CONFIG and character storage</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">} </span><span class="hl-1">as</span><span class="hl-2"> </span><span class="hl-8">Package</span><span class="hl-2">;</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">loadPackage</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;package-loader&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">characterPkg</span><span class="hl-2">, { </span><span class="hl-3">saveCharacter</span><span class="hl-2">, </span><span class="hl-3">loadCharacter</span><span class="hl-2">, </span><span class="hl-3">isCharacterActive</span><span class="hl-2">, </span><span class="hl-3">unregisterActiveCharacter</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/package/character.ts&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">Character</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;./src/character.ts&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadPackage</span><span class="hl-2">(</span><span class="hl-3">characterPkg</span><span class="hl-2">);</span><br/><br/><span class="hl-7">const</span><span class="hl-2"> </span><span class="hl-6">player</span><span class="hl-2"> = </span><span class="hl-7">new</span><span class="hl-2"> </span><span class="hl-5">Character</span><span class="hl-2">({ </span><span class="hl-3">credentials:</span><span class="hl-2"> { </span><span class="hl-3">username:</span><span class="hl-2"> </span><span class="hl-4">&#39;Alice&#39;</span><span class="hl-2"> } });</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">saveCharacter</span><span class="hl-2">(</span><span class="hl-3">player</span><span class="hl-2">);</span><br/><br/><span class="hl-7">const</span><span class="hl-2"> </span><span class="hl-6">reloaded</span><span class="hl-2"> = </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">loadCharacter</span><span class="hl-2">(</span><span class="hl-4">&#39;Alice&#39;</span><span class="hl-2">);</span><br/><span class="hl-1">if</span><span class="hl-2"> (</span><span class="hl-3">reloaded</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">&#39;Loaded&#39;</span><span class="hl-2">, </span><span class="hl-3">reloaded</span><span class="hl-2">.</span><span class="hl-3">credentials</span><span class="hl-2">.</span><span class="hl-3">username</span><span class="hl-2">);</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Later, on disconnect</span><br/><span class="hl-5">unregisterActiveCharacter</span><span class="hl-2">(</span><span class="hl-4">&#39;Alice&#39;</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="directory-conventions-summary" class="tsd-anchor-link">Directory conventions summary<a href="#directory-conventions-summary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><code>data/config.yaml</code> — game/server/security config (autocreated if missing)</li>
<li><code>data/commands/*.js</code> — runtime command modules</li>
<li><code>data/characters/*.yaml</code> — character saves</li>
<li><code>.lock</code> — process lock file (created/removed by lockfile package)</li>
</ul>
<hr>
<h2 id="tips" class="tsd-anchor-link">Tips<a href="#tips" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Logging: console logging is disabled during tests; file logs go to <code>logs/</code> with JSON lines. Set <code>LOG_LEVEL</code> to adjust console verbosity.</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#mud3-packages-guide"><span>mud3 packages guide</span></a><ul><li><a href="#quick-start-running-loaders"><span>Quick start: running loaders</span></a></li><li><a href="#package"><span>package</span></a></li><li><ul><li><a href="#commands"><span>commands</span></a></li><li><ul><li><a href="#command-shape"><span>Command shape</span></a></li><li><a href="#using-the-loader-via-package-loader"><span>Using the loader (via package-<wbr/>loader)</span></a></li></ul></li><li><a href="#config"><span>config</span></a></li><li><ul><li><a href="#yaml-configuration-loader"><span>YAML configuration loader</span></a></li><li><a href="#shapes"><span>Shapes</span></a></li><li><a href="#defaults-and-usage"><span>Defaults and usage</span></a></li></ul></li><li><a href="#lockfile-single-instance-process-lock"><span>lockfile (single-<wbr/>instance process lock)</span></a></li><li><ul><li><a href="#using-the-loader-via-package-loader-1"><span>Using the loader (via package-<wbr/>loader)</span></a></li><li><a href="#standalone-utilities"><span>Standalone utilities</span></a></li></ul></li><li><a href="#character"><span>character</span></a></li><li><a href="#api-and-usage"><span>API and usage</span></a></li></ul></li><li><a href="#directory-conventions-summary"><span>Directory conventions summary</span></a></li><li><a href="#tips"><span>Tips</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">mud3</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
