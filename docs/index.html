<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>mud3</title><meta name="description" content="Documentation for mud3"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">mud3</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>mud3</h1></div><div class="tsd-panel tsd-typography"><h1 id="mud3" class="tsd-anchor-link">mud3<a href="#mud3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>mud3 is a modern TypeScript-based Multi-User Dungeon (MUD) server framework designed for building persistent online text-based games. It provides a complete foundation with built-in systems for player management, world modeling, communication, and command handling. The framework emphasizes extensibility, type safety, and developer experience, making it easy to create and customize your own MUD server.</p>
<p>The server architecture is modular and package-based, allowing you to extend functionality through a simple loader system. All game data is persisted using YAML files with atomic write operations to prevent corruption, ensuring data integrity even during unexpected shutdowns.</p>
<h1 id="features" class="tsd-anchor-link">Features<a href="#features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="1-efficient-and-user-accessible-command-pattern-system" class="tsd-anchor-link">1. Efficient and user-accessible command pattern system<a href="#1-efficient-and-user-accessible-command-pattern-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The command system uses declarative patterns to define commands with typed arguments, automatic parsing, and validation. Commands can be defined in TypeScript classes, JavaScript modules, or YAML files, providing flexibility for different use cases.</p>
<h3 id="key-features" class="tsd-anchor-link">Key Features<a href="#key-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Pattern-based syntax</strong>: Define commands using human-readable patterns like <code>&quot;say &lt;message:text&gt;&quot;</code> or <code>&quot;get &lt;item:object@room&gt;&quot;</code></li>
<li><strong>Typed arguments</strong>: Built-in argument types including <code>text</code>, <code>word</code>, <code>number</code>, <code>object</code>, <code>mob</code>, <code>item</code>, <code>direction</code>, and <code>character</code></li>
<li><strong>Source modifiers</strong>: Specify where to search for objects using <code>@room</code>, <code>@inventory</code>, or <code>@all</code></li>
<li><strong>Autocomplete support</strong>: Use the <code>~</code> suffix on literal words to enable partial matching (e.g., <code>&quot;ooc~&quot;</code> matches &quot;o&quot;, &quot;oo&quot;, or &quot;ooc&quot;)</li>
<li><strong>Optional arguments</strong>: Mark arguments as optional with <code>?</code> suffix (e.g., <code>&quot;look &lt;direction:direction?&gt;&quot;</code>)</li>
<li><strong>Command aliases</strong>: Support multiple patterns per command for alternate phrasings</li>
<li><strong>Automatic priority</strong>: Commands are matched longest-first, ensuring specific patterns are tried before general ones</li>
<li><strong>Custom error handling</strong>: Implement <code>onError()</code> methods to provide user-friendly error messages</li>
</ul>
<h3 id="usage-examples" class="tsd-anchor-link">Usage Examples<a href="#usage-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>TypeScript Command:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Command</span><span class="hl-1">, </span><span class="hl-2">CommandContext</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./command.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-5">SayCommand</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-5">Command</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">pattern</span><span class="hl-1"> = </span><span class="hl-3">&quot;say &lt;message:text&gt;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">execute</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">: </span><span class="hl-5">CommandContext</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">: </span><span class="hl-5">Map</span><span class="hl-1">&lt;</span><span class="hl-5">string</span><span class="hl-1">, </span><span class="hl-5">any</span><span class="hl-1">&gt;) {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">message</span><span class="hl-1"> = </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&quot;message&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">actor</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">`You say: </span><span class="hl-4">${</span><span class="hl-2">message</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>YAML Command:</strong></p>
<pre><code class="yaml"><span class="hl-8"># data/commands/greet.yaml</span><br/><span class="hl-9">pattern</span><span class="hl-1">: </span><span class="hl-10">greet &lt;target:character&gt;</span><br/><span class="hl-9">execute</span><span class="hl-1">: </span><span class="hl-0">|</span><br/><span class="hl-10">  function(context, args) {</span><br/><span class="hl-10">    const target = args.get(&quot;target&quot;);</span><br/><span class="hl-10">    context.actor.sendLine(`You greet ${target.display}!`);</span><br/><span class="hl-10">  }</span>
</code><button type="button">Copy</button></pre>

<p><strong>JavaScript Command:</strong></p>
<pre><code class="javascript"><span class="hl-8">// data/commands/wave.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">pattern:</span><span class="hl-1"> </span><span class="hl-3">&quot;wave &lt;target:mob?&gt;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">execute</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">target</span><span class="hl-1"> = </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&quot;target&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">target</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">actor</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">`You wave at </span><span class="hl-4">${</span><span class="hl-2">target</span><span class="hl-11">.</span><span class="hl-2">display</span><span class="hl-4">}</span><span class="hl-3">.`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">actor</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">&quot;You wave.&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<h2 id="2-expandable-channel-system" class="tsd-anchor-link">2. Expandable channel system<a href="#2-expandable-channel-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The channel system provides multiple communication channels that players can subscribe to, each with distinct color schemes and message formatting. Channels support both public and private messaging, with built-in user blocking capabilities.</p>
<h3 id="key-features-1" class="tsd-anchor-link">Key Features<a href="#key-features-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Multiple channels</strong>: OOC (Out of Character), NEWBIE, TRADE, GOSSIP, SAY (in-character speech), and WHISPER (private messages)</li>
<li><strong>Channel subscription management</strong>: Players can subscribe/unsubscribe to channels using the <code>channels</code> command</li>
<li><strong>Color-coded messages</strong>: Each channel has distinct color schemes for easy visual identification</li>
<li><strong>Message targeting</strong>: WHISPER channel supports private messaging with <code>@mentions</code> and <code>reply</code> command support</li>
<li><strong>User blocking</strong>: Block users to prevent whispers and unwanted messages</li>
<li><strong>Default subscriptions</strong>: Channels can be configured with default on/off states</li>
</ul>
<h3 id="usage-examples-1" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Managing Channels:</strong></p>
<pre><code><span class="hl-2">channels</span><span class="hl-1">                    # </span><span class="hl-2">List</span><span class="hl-1"> </span><span class="hl-2">all</span><span class="hl-1"> </span><span class="hl-2">channels</span><span class="hl-1"> </span><span class="hl-0">with</span><span class="hl-1"> </span><span class="hl-2">subscription</span><span class="hl-1"> </span><span class="hl-2">status</span><br/><span class="hl-2">channels</span><span class="hl-1"> </span><span class="hl-2">on</span><span class="hl-1"> </span><span class="hl-2">newbie</span><span class="hl-1">          # </span><span class="hl-2">Subscribe</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-7">NEWBIE</span><span class="hl-1"> </span><span class="hl-2">channel</span><br/><span class="hl-2">channels</span><span class="hl-1"> </span><span class="hl-2">off</span><span class="hl-1"> </span><span class="hl-2">gossip</span><span class="hl-1">         # </span><span class="hl-2">Unsubscribe</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-7">GOSSIP</span><span class="hl-1"> </span><span class="hl-2">channel</span><br/><span class="hl-2">channels</span><span class="hl-1"> </span><span class="hl-2">enable</span><span class="hl-1"> </span><span class="hl-2">trade</span><span class="hl-1">       # </span><span class="hl-2">Subscribe</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-7">TRADE</span><span class="hl-1"> </span><span class="hl-2">channel</span><br/><span class="hl-2">channels</span><span class="hl-1"> </span><span class="hl-2">disable</span><span class="hl-1"> </span><span class="hl-2">ooc</span><span class="hl-1">        # </span><span class="hl-2">Unsubscribe</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-7">OOC</span><span class="hl-1"> </span><span class="hl-2">channel</span>
</code><button>Copy</button></pre>

<p><strong>Sending Messages:</strong></p>
<pre><code><span class="hl-2">ooc</span><span class="hl-1"> </span><span class="hl-2">Hello</span><span class="hl-1"> </span><span class="hl-2">everyone</span><span class="hl-1">!         # </span><span class="hl-2">Send</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-7">OOC</span><span class="hl-1"> </span><span class="hl-2">channel</span><br/><span class="hl-2">say</span><span class="hl-1"> </span><span class="hl-7">I</span><span class="hl-1"> </span><span class="hl-2">walk</span><span class="hl-1"> </span><span class="hl-2">into</span><span class="hl-1"> </span><span class="hl-2">the</span><span class="hl-1"> </span><span class="hl-2">room</span><span class="hl-1">.   # </span><span class="hl-2">Send</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-7">SAY</span><span class="hl-1"> </span><span class="hl-6">channel</span><span class="hl-1"> (</span><span class="hl-4">in</span><span class="hl-1">-</span><span class="hl-2">character</span><span class="hl-1">)</span><br/><span class="hl-2">whisper</span><span class="hl-1"> </span><span class="hl-2">bob</span><span class="hl-1"> </span><span class="hl-2">Hello</span><span class="hl-1">!          # </span><span class="hl-2">Send</span><span class="hl-1"> </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-2">message</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-2">bob</span><br/><span class="hl-2">reply</span><span class="hl-1"> </span><span class="hl-2">Thanks</span><span class="hl-1">!               # </span><span class="hl-2">Reply</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-2">last</span><span class="hl-1"> </span><span class="hl-2">whisper</span>
</code><button>Copy</button></pre>

<h2 id="3-easy-to-use-message-board-system" class="tsd-anchor-link">3. Easy-to-use message board system<a href="#3-easy-to-use-message-board-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The message board system provides persistent note boards with an interactive multi-line editor, message targeting, read tracking, and flexible expiration policies. Boards can be configured as permanent (messages never expire) or time-limited (messages automatically expire after a set duration).</p>
<h3 id="key-features-2" class="tsd-anchor-link">Key Features<a href="#key-features-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Interactive editor</strong>: Rich multi-line message editor with commands for editing, previewing, and managing messages</li>
<li><strong>Message targeting</strong>: Target messages to specific users with <code>@mentions</code> or make them public</li>
<li><strong>Read tracking</strong>: Track which characters have read each message using unique character IDs</li>
<li><strong>Read status display</strong>: See <code>[read]</code> or <code>[unread]</code> status for each message in the board list</li>
<li><strong>Quick read next</strong>: Use <code>board &lt;name&gt; read next</code> to read the oldest unread message</li>
<li><strong>Login notifications</strong>: Automatically notified of unread messages when you log in</li>
<li><strong>Targeted message alerts</strong>: Instant notifications when someone sends you a targeted message</li>
<li><strong>Expiration policies</strong>: Boards can be permanent or time-limited with automatic cleanup</li>
<li><strong>Write permissions</strong>: Configure boards to allow all users or restrict to admins only</li>
<li><strong>Auto-save</strong>: Boards automatically saved on server shutdown</li>
<li><strong>Auto-cleanup</strong>: Expired messages automatically removed from time-limited boards</li>
</ul>
<h3 id="targetable-messages" class="tsd-anchor-link">Targetable Messages<a href="#targetable-messages" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Messages can be targeted to specific users using <code>@mentions</code> when writing. Targeted messages are only visible to the author and the mentioned users. When a targeted message is posted, all mentioned users who are currently online and have access to the board will receive an instant notification telling them they have mail and exactly what command to type to read it.</p>
<p><strong>Example:</strong></p>
<pre><code><span class="hl-2">board</span><span class="hl-1"> </span><span class="hl-2">write</span><span class="hl-1"> </span><span class="hl-2">general</span><br/><span class="hl-1">&gt; @</span><span class="hl-2">bob</span><span class="hl-1"> @</span><span class="hl-2">alice</span><br/><span class="hl-1">&gt; </span><span class="hl-12">Subject</span><span class="hl-1">: </span><span class="hl-2">Meeting</span><span class="hl-1"> </span><span class="hl-2">reminder</span><br/><span class="hl-1">&gt; </span><span class="hl-2">Don</span><span class="hl-3">&#39;t forget about the meeting tomorrow</span><span class="hl-13">!</span><br/><span class="hl-1">&gt; !</span><span class="hl-2">done</span>
</code><button>Copy</button></pre>

<p>This creates a message that only bob, alice, and the author can see. Both bob and alice will receive a notification: &quot;You have new mail on the General board from username. Type: board general read 5&quot;</p>
<h3 id="writing-interface" class="tsd-anchor-link">Writing Interface<a href="#writing-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The board system includes a powerful interactive editor for writing multi-line messages. The editor supports various commands for managing your message as you write it.</p>
<p><strong>Editor Commands:</strong></p>
<ul>
<li><code>!done</code> - Finish editing and preview the message</li>
<li><code>!show</code> - Display the current message body with line numbers</li>
<li><code>!delete &lt;n&gt;</code> - Delete line number <code>&lt;n&gt;</code> from the body</li>
<li><code>!insert &lt;n&gt; &lt;text&gt;</code> - Insert a line at position <code>&lt;n&gt;</code>, pushing existing lines down</li>
<li><code>!subject &lt;text&gt;</code> - Change the message subject inline</li>
<li><code>!to &lt;@targets&gt;</code> - Change message targets inline (use <code>@all</code> for public)</li>
<li><code>!forget</code> / <code>!quit</code> - Cancel message creation</li>
<li><code>!help</code> - Show command reference</li>
</ul>
<p><strong>Example Writing Session:</strong></p>
<pre><code><span class="hl-2">board</span><span class="hl-1"> </span><span class="hl-2">write</span><span class="hl-1"> </span><span class="hl-2">general</span><br/><span class="hl-1">&gt; @</span><span class="hl-2">bob</span><br/><span class="hl-1">&gt; </span><span class="hl-2">Important</span><span class="hl-1"> </span><span class="hl-2">update</span><br/><span class="hl-1">&gt; </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">one</span><span class="hl-1">.</span><br/><span class="hl-1">&gt; </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">two</span><span class="hl-1">.</span><br/><span class="hl-1">&gt; !</span><span class="hl-2">show</span><br/><span class="hl-1">&gt;   </span><span class="hl-14">1</span><span class="hl-1">: </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">one</span><span class="hl-1">.</span><br/><span class="hl-1">&gt;   </span><span class="hl-14">2</span><span class="hl-1">: </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">two</span><span class="hl-1">.</span><br/><span class="hl-1">&gt; !</span><span class="hl-2">insert</span><span class="hl-1"> </span><span class="hl-14">2</span><span class="hl-1"> </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">two</span><span class="hl-1">.</span><br/><span class="hl-1">&gt; !</span><span class="hl-2">show</span><br/><span class="hl-1">&gt;   </span><span class="hl-14">1</span><span class="hl-1">: </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">one</span><span class="hl-1">.</span><br/><span class="hl-1">&gt;   </span><span class="hl-14">2</span><span class="hl-1">: </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">two</span><span class="hl-1">.</span><br/><span class="hl-1">&gt;   </span><span class="hl-14">3</span><span class="hl-1">: </span><span class="hl-2">This</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">line</span><span class="hl-1"> </span><span class="hl-2">two</span><span class="hl-1">.</span><br/><span class="hl-1">&gt; !</span><span class="hl-4">delete</span><span class="hl-1"> </span><span class="hl-14">3</span><br/><span class="hl-1">&gt; !</span><span class="hl-2">done</span>
</code><button>Copy</button></pre>

<h3 id="read-tracking-using-character-ids" class="tsd-anchor-link">Read Tracking Using Character IDs<a href="#read-tracking-using-character-ids" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Each character in the game has a unique character ID assigned when they are created. The board system uses these IDs to track which characters have read each message. When you read a message, your character ID is automatically added to that message's <code>readBy</code> list, and the board is saved to persist this information.</p>
<p>This system ensures accurate read tracking even if a player changes their username, and allows the system to efficiently determine read status without storing per-character read lists.</p>
<h3 id="reading-the-oldest-unread-message" class="tsd-anchor-link">Reading the Oldest Unread Message<a href="#reading-the-oldest-unread-message" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>board &lt;name&gt; read</code> command finds and displays the oldest unread message on the specified board that is visible to you. This makes it easy to catch up on messages you haven't read yet without having to manually check each message ID.</p>
<p><strong>Example:</strong></p>
<pre><code><span class="hl-2">board</span><span class="hl-1"> </span><span class="hl-2">general</span><span class="hl-1"> </span><span class="hl-2">read</span>
</code><button>Copy</button></pre>

<p>This will find the oldest message on the general board that you haven't read yet and display it, automatically marking it as read.</p>
<h3 id="login-unread-message-notifications" class="tsd-anchor-link">Login Unread Message Notifications<a href="#login-unread-message-notifications" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>When you log into the game, the system automatically checks all boards you have access to and shows you a summary of unread activity. The notification system shows two types of alerts:</p>
<ol>
<li>
<p><strong>General board activity</strong>: Shows boards that have new messages since your last login (without specific details).</p>
<ul>
<li>Example: &quot;• General has 5 new messages.&quot;</li>
</ul>
</li>
<li>
<p><strong>Direct messages</strong>: Shows specific messages that were targeted directly at you</p>
<ul>
<li>Example: &quot;• New message from username on the General board. Type: board general read 3&quot;</li>
</ul>
</li>
</ol>
<p>These notifications only show messages posted after your last login date, ensuring you only see relevant new activity. The notifications are displayed in a message when you first connect.</p>
<h3 id="targeted-message-notifications" class="tsd-anchor-link">Targeted Message Notifications<a href="#targeted-message-notifications" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>When someone posts a message targeting you (using <code>@yourname</code>), you receive an instant notification if you're currently online. The notification tells you:</p>
<ul>
<li>Who sent the message</li>
<li>Which board it's on</li>
<li>The exact command to read it: <code>board &lt;boardname&gt; read &lt;id&gt;</code></li>
</ul>
<p>If the message is on a board with admin-only access and you don't have admin privileges, you won't receive the notification (since you can't access that board anyway).</p>
<h3 id="board-yaml-format" class="tsd-anchor-link">Board YAML Format<a href="#board-yaml-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Boards are saved to two separate files in <code>data/boards/</code>:</p>
<ul>
<li><code>&lt;name&gt;.yaml</code> - Board configuration</li>
<li><code>&lt;name&gt;.messages.yaml</code> - Board messages</li>
</ul>
<p><strong>Board Configuration (<code>&lt;name&gt;.yaml</code>):</strong></p>
<pre><code class="yaml"><span class="hl-9">name</span><span class="hl-1">: </span><span class="hl-10">general</span><br/><span class="hl-9">displayName</span><span class="hl-1">: </span><span class="hl-10">General</span><br/><span class="hl-9">description</span><span class="hl-1">: </span><span class="hl-10">General discussion</span><br/><span class="hl-9">permanent</span><span class="hl-1">: </span><span class="hl-4">false</span><span class="hl-1">          </span><span class="hl-8"># these messages expire</span><br/><span class="hl-9">expirationMs</span><span class="hl-1">: </span><span class="hl-14">2592000000</span><span class="hl-1">  </span><span class="hl-8"># Optional: milliseconds before messages expire (only used if permanent=false)</span><br/><span class="hl-9">writePermission</span><span class="hl-1">: </span><span class="hl-10">all</span><span class="hl-1">      </span><span class="hl-8"># &quot;all&quot; or &quot;admin&quot;</span><br/><span class="hl-9">nextMessageId</span><span class="hl-1">: </span><span class="hl-14">3</span><span class="hl-1">          </span><span class="hl-8"># Next ID to use for new messages</span>
</code><button type="button">Copy</button></pre>

<p><strong>Board Messages (<code>&lt;name&gt;.messages.yaml</code>):</strong></p>
<pre><code class="yaml"><span class="hl-9">messages</span><span class="hl-1">:</span><br/><span class="hl-1">  - </span><span class="hl-9">id</span><span class="hl-1">: </span><span class="hl-14">1</span><br/><span class="hl-1">    </span><span class="hl-9">author</span><span class="hl-1">: </span><span class="hl-10">username</span><br/><span class="hl-1">    </span><span class="hl-9">subject</span><span class="hl-1">: </span><span class="hl-10">Message subject</span><br/><span class="hl-1">    </span><span class="hl-9">content</span><span class="hl-1">: </span><span class="hl-3">&quot;Message content with</span><span class="hl-15">\r\n</span><span class="hl-3">multiple lines&quot;</span><br/><span class="hl-1">    </span><span class="hl-9">postedAt</span><span class="hl-1">: </span><span class="hl-3">&quot;2024-01-15T10:30:00.000Z&quot;</span><br/><span class="hl-1">    </span><span class="hl-9">targets</span><span class="hl-1">:              </span><span class="hl-8"># Optional: list of usernames, or omit for public messages</span><br/><span class="hl-1">      - </span><span class="hl-10">username1</span><br/><span class="hl-1">      - </span><span class="hl-10">username2</span><br/><span class="hl-1">    </span><span class="hl-9">readBy</span><span class="hl-1">:               </span><span class="hl-8"># Optional: list of character IDs who have read this message</span><br/><span class="hl-1">      - </span><span class="hl-14">1</span><br/><span class="hl-1">      - </span><span class="hl-14">5</span><br/><span class="hl-1">  - </span><span class="hl-9">id</span><span class="hl-1">: </span><span class="hl-14">2</span><br/><span class="hl-1">    </span><span class="hl-9">author</span><span class="hl-1">: </span><span class="hl-10">anotheruser</span><br/><span class="hl-1">    </span><span class="hl-9">subject</span><span class="hl-1">: </span><span class="hl-10">Another message</span><br/><span class="hl-1">    </span><span class="hl-9">content</span><span class="hl-1">: </span><span class="hl-3">&quot;Single line message&quot;</span><br/><span class="hl-1">    </span><span class="hl-9">postedAt</span><span class="hl-1">: </span><span class="hl-3">&quot;2024-01-15T11:00:00.000Z&quot;</span>
</code><button type="button">Copy</button></pre>

<p>The system automatically loads both files when a board is accessed. If the messages file is missing, the board will load with an empty message list.</p>
<h2 id="4-dungeon-and-dungeonobject-and-room-systems" class="tsd-anchor-link">4. Dungeon and DungeonObject and Room systems<a href="#4-dungeon-and-dungeonobject-and-room-systems" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The dungeon system provides a complete three-dimensional world model with rooms organized in a grid system (width × height × layers). The system supports cardinal and vertical movement, object containment hierarchies, and serialization for persistence.</p>
<h3 id="key-features-3" class="tsd-anchor-link">Key Features<a href="#key-features-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>3D grid system</strong>: Rooms organized in width × height × layers</li>
<li><strong>Movement system</strong>: Cardinal directions (N/S/E/W) and vertical (UP/DOWN)</li>
<li><strong>Object containment</strong>: Objects can be in rooms, inventories, or nested containers</li>
<li><strong>Entity types</strong>: Rooms, Mobs (NPCs/players), Items, and Props</li>
<li><strong>Serialization</strong>: Full serialization/deserialization support for persistence</li>
<li><strong>Type safety</strong>: Full TypeScript types throughout</li>
</ul>
<h3 id="usage-examples-2" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Creating a Dungeon:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Dungeon</span><span class="hl-1">, </span><span class="hl-2">DIRECTION</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./dungeon.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">dungeon</span><span class="hl-1"> = </span><span class="hl-2">Dungeon</span><span class="hl-1">.</span><span class="hl-6">generateEmptyDungeon</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-3">&quot;midgar&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">dimensions:</span><span class="hl-1"> { </span><span class="hl-2">width:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">height:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">layers:</span><span class="hl-1"> </span><span class="hl-14">3</span><span class="hl-1"> }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">startRoom</span><span class="hl-1"> = </span><span class="hl-2">dungeon</span><span class="hl-1">.</span><span class="hl-6">getRoom</span><span class="hl-1">({ </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">y:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">z:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1"> });</span>
</code><button type="button">Copy</button></pre>

<p><strong>Moving Entities:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Movable</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./dungeon.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">player</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Movable</span><span class="hl-1">({ </span><span class="hl-2">display:</span><span class="hl-1"> </span><span class="hl-3">&quot;Player&quot;</span><span class="hl-1">, </span><span class="hl-2">keywords:</span><span class="hl-1"> </span><span class="hl-3">&quot;player&quot;</span><span class="hl-1"> });</span><br/><span class="hl-2">startRoom</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-2">player</span><span class="hl-1">);</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">player</span><span class="hl-1">.</span><span class="hl-6">canStep</span><span class="hl-1">(</span><span class="hl-7">DIRECTION</span><span class="hl-1">.</span><span class="hl-7">NORTH</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-2">player</span><span class="hl-1">.</span><span class="hl-6">step</span><span class="hl-1">(</span><span class="hl-7">DIRECTION</span><span class="hl-1">.</span><span class="hl-7">NORTH</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Object Containment:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Item</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./dungeon.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">sword</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Item</span><span class="hl-1">({ </span><span class="hl-2">display:</span><span class="hl-1"> </span><span class="hl-3">&quot;Sword&quot;</span><span class="hl-1">, </span><span class="hl-2">keywords:</span><span class="hl-1"> </span><span class="hl-3">&quot;sword&quot;</span><span class="hl-1"> });</span><br/><span class="hl-2">player</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-2">sword</span><span class="hl-1">);  </span><span class="hl-8">// Sword is now in player&#39;s inventory</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">bag</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Item</span><span class="hl-1">({ </span><span class="hl-2">display:</span><span class="hl-1"> </span><span class="hl-3">&quot;Bag&quot;</span><span class="hl-1">, </span><span class="hl-2">keywords:</span><span class="hl-1"> </span><span class="hl-3">&quot;bag&quot;</span><span class="hl-1"> });</span><br/><span class="hl-2">player</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-2">bag</span><span class="hl-1">);</span><br/><span class="hl-2">bag</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-2">sword</span><span class="hl-1">);  </span><span class="hl-8">// Sword is now in the bag, which is in player&#39;s inventory</span>
</code><button type="button">Copy</button></pre>

<h2 id="5-the-dungeon-registry-system" class="tsd-anchor-link">5. The dungeon registry system<a href="#5-the-dungeon-registry-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The dungeon registry provides a global lookup mechanism for dungeons by their unique identifier. This enables cross-dungeon navigation, serialization, and room references.</p>
<h3 id="key-features-4" class="tsd-anchor-link">Key Features<a href="#key-features-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Global registry</strong>: All dungeons with an <code>id</code> are automatically registered</li>
<li><strong>Lookup by ID</strong>: Use <code>getDungeonById(id)</code> to retrieve registered dungeons</li>
<li><strong>Type-safe access</strong>: Readonly map interface prevents accidental modification</li>
<li><strong>Automatic registration</strong>: Setting a dungeon's <code>id</code> automatically registers it</li>
</ul>
<h3 id="usage-examples-3" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Registering a Dungeon:</strong></p>
<pre><code class="typescript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">dungeon</span><span class="hl-1"> = </span><span class="hl-2">Dungeon</span><span class="hl-1">.</span><span class="hl-6">generateEmptyDungeon</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-3">&quot;midgar&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">dimensions:</span><span class="hl-1"> { </span><span class="hl-2">width:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">height:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">layers:</span><span class="hl-1"> </span><span class="hl-14">1</span><span class="hl-1"> }</span><br/><span class="hl-1">});</span><br/><span class="hl-8">// Automatically registered in DUNGEON_REGISTRY</span>
</code><button type="button">Copy</button></pre>

<p><strong>Looking Up a Dungeon:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">getDungeonById</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./dungeon.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">found</span><span class="hl-1"> = </span><span class="hl-6">getDungeonById</span><span class="hl-1">(</span><span class="hl-3">&quot;midgar&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">found</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">room</span><span class="hl-1"> = </span><span class="hl-2">found</span><span class="hl-1">.</span><span class="hl-6">getRoom</span><span class="hl-1">({ </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">y:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">z:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1"> });</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="6-the-room-link-system" class="tsd-anchor-link">6. The Room Link system<a href="#6-the-room-link-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Room Link system allows you to create custom connections between non-adjacent rooms, enabling complex world layouts beyond simple grid adjacency. Links can connect rooms within the same dungeon or across different dungeons.</p>
<h3 id="key-features-5" class="tsd-anchor-link">Key Features<a href="#key-features-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Custom connections</strong>: Create tunnels, portals, or other non-standard room connections</li>
<li><strong>Cross-dungeon links</strong>: Connect rooms in different dungeons</li>
<li><strong>Bidirectional links</strong>: Links can be one-way or two-way</li>
<li><strong>Direction-based</strong>: Links are associated with specific directions</li>
</ul>
<h3 id="usage-examples-4" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Creating a Room Link:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">RoomLink</span><span class="hl-1">, </span><span class="hl-2">DIRECTION</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./dungeon.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">roomA</span><span class="hl-1"> = </span><span class="hl-2">dungeon</span><span class="hl-1">.</span><span class="hl-6">getRoom</span><span class="hl-1">({ </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1">, </span><span class="hl-2">y:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1">, </span><span class="hl-2">z:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1"> });</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">roomB</span><span class="hl-1"> = </span><span class="hl-2">dungeon</span><span class="hl-1">.</span><span class="hl-6">getRoom</span><span class="hl-1">({ </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-14">9</span><span class="hl-1">, </span><span class="hl-2">y:</span><span class="hl-1"> </span><span class="hl-14">9</span><span class="hl-1">, </span><span class="hl-2">z:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1"> });</span><br/><br/><span class="hl-8">// Create a tunnel from roomA going north to roomB</span><br/><span class="hl-2">RoomLink</span><span class="hl-1">.</span><span class="hl-6">createTunnel</span><span class="hl-1">(</span><span class="hl-2">roomA</span><span class="hl-1">, </span><span class="hl-7">DIRECTION</span><span class="hl-1">.</span><span class="hl-7">NORTH</span><span class="hl-1">, </span><span class="hl-2">roomB</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Cross-Dungeon Links:</strong></p>
<pre><code class="typescript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">dungeon1</span><span class="hl-1"> = </span><span class="hl-2">Dungeon</span><span class="hl-1">.</span><span class="hl-6">generateEmptyDungeon</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-3">&quot;overworld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">dimensions:</span><span class="hl-1"> { </span><span class="hl-2">width:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">height:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">layers:</span><span class="hl-1"> </span><span class="hl-14">1</span><span class="hl-1"> }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">dungeon2</span><span class="hl-1"> = </span><span class="hl-2">Dungeon</span><span class="hl-1">.</span><span class="hl-6">generateEmptyDungeon</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-3">&quot;underworld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">dimensions:</span><span class="hl-1"> { </span><span class="hl-2">width:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">height:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">layers:</span><span class="hl-1"> </span><span class="hl-14">1</span><span class="hl-1"> }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">overworldRoom</span><span class="hl-1"> = </span><span class="hl-2">dungeon1</span><span class="hl-1">.</span><span class="hl-6">getRoom</span><span class="hl-1">({ </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">y:</span><span class="hl-1"> </span><span class="hl-14">5</span><span class="hl-1">, </span><span class="hl-2">z:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1"> });</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">underworldRoom</span><span class="hl-1"> = </span><span class="hl-2">dungeon2</span><span class="hl-1">.</span><span class="hl-6">getRoom</span><span class="hl-1">({ </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-14">2</span><span class="hl-1">, </span><span class="hl-2">y:</span><span class="hl-1"> </span><span class="hl-14">2</span><span class="hl-1">, </span><span class="hl-2">z:</span><span class="hl-1"> </span><span class="hl-14">0</span><span class="hl-1"> });</span><br/><br/><span class="hl-8">// Create a portal between dungeons</span><br/><span class="hl-2">RoomLink</span><span class="hl-1">.</span><span class="hl-6">createTunnel</span><span class="hl-1">(</span><span class="hl-2">overworldRoom</span><span class="hl-1">, </span><span class="hl-7">DIRECTION</span><span class="hl-1">.</span><span class="hl-7">DOWN</span><span class="hl-1">, </span><span class="hl-2">underworldRoom</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h2 id="7-the-room-ref-system" class="tsd-anchor-link">7. The room ref system<a href="#7-the-room-ref-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The room ref system provides a string-based reference format for rooms that enables efficient serialization and cross-dungeon navigation. Room references use the format <code>@dungeon-id{x,y,z}</code>.</p>
<h3 id="key-features-6" class="tsd-anchor-link">Key Features<a href="#key-features-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>String references</strong>: Use <code>@dungeon-id{x,y,z}</code> format to reference rooms</li>
<li><strong>Cross-dungeon support</strong>: References work across different dungeons</li>
<li><strong>Serialization-friendly</strong>: Easy to store and restore room references</li>
<li><strong>Type-safe parsing</strong>: <code>getRoomByRef()</code> validates and resolves references</li>
</ul>
<h3 id="usage-examples-5" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Creating Room References:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">getRoomByRef</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./dungeon.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">dungeon</span><span class="hl-1"> = </span><span class="hl-2">Dungeon</span><span class="hl-1">.</span><span class="hl-6">generateEmptyDungeon</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-3">&quot;midgar&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">dimensions:</span><span class="hl-1"> { </span><span class="hl-2">width:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">height:</span><span class="hl-1"> </span><span class="hl-14">10</span><span class="hl-1">, </span><span class="hl-2">layers:</span><span class="hl-1"> </span><span class="hl-14">3</span><span class="hl-1"> }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-8">// Get a room using reference format</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">room</span><span class="hl-1"> = </span><span class="hl-6">getRoomByRef</span><span class="hl-1">(</span><span class="hl-3">&quot;@midgar{5,3,1}&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">room</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">`Found room at </span><span class="hl-4">${</span><span class="hl-2">room</span><span class="hl-11">.</span><span class="hl-2">x</span><span class="hl-4">}</span><span class="hl-3">,</span><span class="hl-4">${</span><span class="hl-2">room</span><span class="hl-11">.</span><span class="hl-2">y</span><span class="hl-4">}</span><span class="hl-3">,</span><span class="hl-4">${</span><span class="hl-2">room</span><span class="hl-11">.</span><span class="hl-2">z</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Using in Serialization:</strong></p>
<pre><code class="typescript"><span class="hl-8">// Store room reference in character data</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">characterData</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-2">location:</span><span class="hl-1"> </span><span class="hl-3">&quot;@midgar{5,5,0}&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">// ... other data</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-8">// Later, restore location</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">savedLocation</span><span class="hl-1"> = </span><span class="hl-6">getRoomByRef</span><span class="hl-1">(</span><span class="hl-2">characterData</span><span class="hl-1">.</span><span class="hl-2">location</span><span class="hl-1">);</span><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">savedLocation</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">character</span><span class="hl-1">.</span><span class="hl-2">mob</span><span class="hl-1">.</span><span class="hl-2">location</span><span class="hl-1"> = </span><span class="hl-2">savedLocation</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="8-the-simple-client-and-server-system" class="tsd-anchor-link">8. The simple client and server system<a href="#8-the-simple-client-and-server-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The client and server system provides a lightweight telnet-based networking layer with connection management, inactivity timeouts, and graceful shutdown handling. The system is designed to be minimal and predictable for testing.</p>
<h3 id="key-features-7" class="tsd-anchor-link">Key Features<a href="#key-features-7" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Event-driven architecture</strong>: Uses EventEmitter for connection and input events</li>
<li><strong>Line buffering</strong>: Automatically buffers incoming data and emits complete lines</li>
<li><strong>Normalized line endings</strong>: Handles CR/LF normalization automatically</li>
<li><strong>Connection lifecycle</strong>: Tracks connected clients and provides start/stop helpers</li>
<li><strong>Inactivity timeouts</strong>: Automatically disconnects idle clients</li>
<li><strong>Graceful shutdown</strong>: Properly closes all connections on server stop</li>
</ul>
<h3 id="usage-examples-6" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Starting a Server:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">MudServer</span><span class="hl-1">, </span><span class="hl-2">MudClient</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./io.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">server</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">MudServer</span><span class="hl-1">();</span><br/><br/><span class="hl-2">server</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-3">&quot;connection&quot;</span><span class="hl-1">, (</span><span class="hl-2">client</span><span class="hl-1">: </span><span class="hl-5">MudClient</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">&quot;Welcome to the MUD!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-3">&quot;input&quot;</span><span class="hl-1">, (</span><span class="hl-2">line</span><span class="hl-1">: </span><span class="hl-5">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">`You said: </span><span class="hl-4">${</span><span class="hl-2">line</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-3">&quot;close&quot;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;Client disconnected&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">server</span><span class="hl-1">.</span><span class="hl-6">start</span><span class="hl-1">(</span><span class="hl-14">4000</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Client Methods:</strong></p>
<pre><code class="typescript"><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">&quot;Hello!&quot;</span><span class="hl-1">);           </span><span class="hl-8">// Send a line with newline</span><br/><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">send</span><span class="hl-1">(</span><span class="hl-3">&quot;Hello&quot;</span><span class="hl-1">);                </span><span class="hl-8">// Send without newline</span><br/><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">&quot;Prompt: &quot;</span><span class="hl-1">, </span><span class="hl-4">true</span><span class="hl-1">);   </span><span class="hl-8">// Send with color enabled</span><br/><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">close</span><span class="hl-1">();                      </span><span class="hl-8">// Close the connection</span>
</code><button type="button">Copy</button></pre>

<h2 id="9-the-color-system" class="tsd-anchor-link">9. The color system<a href="#9-the-color-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The color system provides full 16-color palette support with dark and bright variants, inline color tags, and utilities for color manipulation and formatting. Colors use a simple <code>{letter}</code> syntax for easy embedding in text.</p>
<h3 id="key-features-8" class="tsd-anchor-link">Key Features<a href="#key-features-8" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>16-color palette</strong>: 8 dark colors and 8 bright colors</li>
<li><strong>Inline color tags</strong>: Use <code>{R</code> for red, <code>{G</code> for green, <code>{Y</code> for yellow, etc.</li>
<li><strong>Background colors</strong>: Support for background color codes</li>
<li><strong>Text styles</strong>: Bold, italic, and other text styling options</li>
<li><strong>Color utilities</strong>: Functions for colorizing, stripping colors, and calculating visible length</li>
<li><strong>Escape sequences</strong>: Use <code>{{</code> to include a literal <code>{</code> character</li>
</ul>
<h3 id="color-codes" class="tsd-anchor-link">Color Codes<a href="#color-codes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><code>{k</code> - Black</li>
<li><code>{r</code> - Maroon (dark red)</li>
<li><code>{g</code> - Dark green</li>
<li><code>{y</code> - Olive (dark yellow)</li>
<li><code>{b</code> - Dark blue</li>
<li><code>{m</code> - Purple</li>
<li><code>{c</code> - Teal</li>
<li><code>{w</code> - Silver (dark white)</li>
<li><code>{K</code> - Grey</li>
<li><code>{R</code> - Crimson (bright red)</li>
<li><code>{G</code> - Lime (bright green)</li>
<li><code>{Y</code> - Yellow</li>
<li><code>{B</code> - Light blue</li>
<li><code>{M</code> - Pink</li>
<li><code>{C</code> - Cyan</li>
<li><code>{W</code> - White</li>
</ul>
<h3 id="usage-examples-7" class="tsd-anchor-link">Usage Examples<a href="#usage-examples-7" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Using Color Tags:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">colorize</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./color.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">message</span><span class="hl-1"> = </span><span class="hl-3">&quot;{RWarning!{x This is important.&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">colored</span><span class="hl-1"> = </span><span class="hl-6">colorize</span><span class="hl-1">(</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-2">colored</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Color Utilities:</strong></p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">colorize</span><span class="hl-1">, </span><span class="hl-2">stripColors</span><span class="hl-1">, </span><span class="hl-2">visibleLength</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./color.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">text</span><span class="hl-1"> = </span><span class="hl-3">&quot;{RHello {GWorld{x&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">colored</span><span class="hl-1"> = </span><span class="hl-6">colorize</span><span class="hl-1">(</span><span class="hl-2">text</span><span class="hl-1">);        </span><span class="hl-8">// Applies color codes</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">plain</span><span class="hl-1"> = </span><span class="hl-6">stripColors</span><span class="hl-1">(</span><span class="hl-2">text</span><span class="hl-1">);       </span><span class="hl-8">// Removes color codes: &quot;Hello World&quot;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">length</span><span class="hl-1"> = </span><span class="hl-6">visibleLength</span><span class="hl-1">(</span><span class="hl-2">text</span><span class="hl-1">);    </span><span class="hl-8">// Returns 11 (ignores color codes)</span>
</code><button type="button">Copy</button></pre>

<h1 id="packages" class="tsd-anchor-link">Packages<a href="#packages" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The mud3 framework uses a package-based architecture for modularity and extensibility. Packages handle persistence, configuration, and system initialization. All packages follow a consistent pattern with a <code>loader</code> function that is called during application startup.</p>
<h2 id="lockfile" class="tsd-anchor-link">lockfile<a href="#lockfile" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The lockfile package prevents multiple server instances from running simultaneously by maintaining a process lock file with PID tracking. It automatically detects and removes stale locks from processes that are no longer running.</p>
<h3 id="key-features-9" class="tsd-anchor-link">Key Features<a href="#key-features-9" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Process lock</strong>: Creates a <code>.lock</code> file with process information</li>
<li><strong>Stale lock detection</strong>: Automatically removes locks from dead processes</li>
<li><strong>Graceful cleanup</strong>: Removes lock file on normal exit and common failure signals</li>
<li><strong>Hostname tracking</strong>: Records hostname for multi-machine environments</li>
</ul>
<h3 id="usage" class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The lockfile package is automatically loaded first in the startup sequence. If another instance is detected, the server will exit with an error message.</p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">lockfile</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/lockfile.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">lockfile</span><span class="hl-1">); </span><span class="hl-8">// Always load first</span>
</code><button type="button">Copy</button></pre>

<h2 id="config" class="tsd-anchor-link">config<a href="#config" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The config package manages YAML-based configuration with default values, type-safe config structures, and automatic default file creation. Configuration is merged from the file into in-memory defaults, ensuring all required settings are present.</p>
<h3 id="key-features-10" class="tsd-anchor-link">Key Features<a href="#key-features-10" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>YAML-based</strong>: Configuration stored in <code>data/config.yaml</code></li>
<li><strong>Type-safe</strong>: TypeScript interfaces for game, server, and security config</li>
<li><strong>Default values</strong>: Automatically creates default config file if missing</li>
<li><strong>Selective merging</strong>: Only known keys from the file are merged into defaults</li>
<li><strong>Atomic writes</strong>: Uses temporary files and atomic rename for safe writes</li>
</ul>
<h3 id="configuration-structure" class="tsd-anchor-link">Configuration Structure<a href="#configuration-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="yaml"><span class="hl-9">game</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-9">name</span><span class="hl-1">: </span><span class="hl-10">mud3</span><br/><span class="hl-1">  </span><span class="hl-9">creator</span><span class="hl-1">: </span><span class="hl-10">jackindisguise</span><br/><span class="hl-9">server</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-9">port</span><span class="hl-1">: </span><span class="hl-14">23</span><br/><span class="hl-1">  </span><span class="hl-9">inactivity_timeout</span><span class="hl-1">: </span><span class="hl-14">1800</span><br/><span class="hl-9">security</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-9">password_salt</span><span class="hl-1">: </span><span class="hl-10">your-secret-salt</span>
</code><button type="button">Copy</button></pre>

<h3 id="usage-1" class="tsd-anchor-link">Usage<a href="#usage-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">config</span><span class="hl-1">, { </span><span class="hl-2">CONFIG</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/config.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">config</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-7">CONFIG</span><span class="hl-1">.</span><span class="hl-2">server</span><span class="hl-1">.</span><span class="hl-2">port</span><span class="hl-1">); </span><span class="hl-8">// 23</span>
</code><button type="button">Copy</button></pre>

<h2 id="help" class="tsd-anchor-link">help<a href="#help" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The help package loads topic-based help files from YAML files in the <code>data/help</code> directory. Each help file includes keywords, aliases, related topics, and content with full-text search capabilities.</p>
<h3 id="key-features-11" class="tsd-anchor-link">Key Features<a href="#key-features-11" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>YAML-based help files</strong>: Each help topic is a separate YAML file</li>
<li><strong>Keywords and aliases</strong>: Multiple ways to reference the same help topic</li>
<li><strong>Related topics</strong>: Cross-referenced help topics for navigation</li>
<li><strong>Full-text search</strong>: Search across all help content</li>
<li><strong>Topic tags</strong>: Categorize help topics by type (e.g., &quot;communication&quot;, &quot;combat&quot;)</li>
</ul>
<h3 id="help-file-format" class="tsd-anchor-link">Help File Format<a href="#help-file-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="yaml"><span class="hl-8"># data/help/combat.yaml</span><br/><span class="hl-9">keyword</span><span class="hl-1">: </span><span class="hl-10">combat</span><br/><span class="hl-9">aliases</span><span class="hl-1">: [</span><span class="hl-10">fight</span><span class="hl-1">, </span><span class="hl-10">battle</span><span class="hl-1">]</span><br/><span class="hl-9">related</span><span class="hl-1">: [</span><span class="hl-10">attack</span><span class="hl-1">, </span><span class="hl-10">defend</span><span class="hl-1">, </span><span class="hl-10">weapons</span><span class="hl-1">]</span><br/><span class="hl-9">topic</span><span class="hl-1">: [</span><span class="hl-10">combat</span><span class="hl-1">, </span><span class="hl-10">fighting</span><span class="hl-1">, </span><span class="hl-10">pvp</span><span class="hl-1">]</span><br/><span class="hl-9">content</span><span class="hl-1">: </span><span class="hl-0">|</span><br/><span class="hl-10">  Combat in the game involves...</span>
</code><button type="button">Copy</button></pre>

<h3 id="usage-2" class="tsd-anchor-link">Usage<a href="#usage-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">help</span><span class="hl-1">, { </span><span class="hl-2">getHelpfile</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/help.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">help</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">helpTopic</span><span class="hl-1"> = </span><span class="hl-6">getHelpfile</span><span class="hl-1">(</span><span class="hl-3">&quot;combat&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">helpTopic</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">helpTopic</span><span class="hl-1">.</span><span class="hl-2">content</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="board" class="tsd-anchor-link">board<a href="#board" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The board package provides persistence for message boards with YAML serialization, automatic directory creation, and board management utilities. Boards are saved to two separate files: <code>data/boards/&lt;name&gt;.yaml</code> (configuration) and <code>data/boards/&lt;name&gt;.messages.yaml</code> (messages) with atomic writes.</p>
<h3 id="key-features-12" class="tsd-anchor-link">Key Features<a href="#key-features-12" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>YAML persistence</strong>: Boards serialized to separate config and messages files</li>
<li><strong>Automatic directory creation</strong>: Creates <code>data/boards</code> directory if needed</li>
<li><strong>Atomic writes</strong>: Uses temporary files and atomic rename to prevent corruption</li>
<li><strong>Board management</strong>: Functions to save, load, list, and delete boards</li>
<li><strong>Graceful degradation</strong>: Loads boards even if messages file is missing</li>
</ul>
<h3 id="board-yaml-format-1" class="tsd-anchor-link">Board YAML Format<a href="#board-yaml-format-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Boards are saved to two separate files in <code>data/boards/</code>:</p>
<ul>
<li><code>&lt;name&gt;.yaml</code> - Board configuration</li>
<li><code>&lt;name&gt;.messages.yaml</code> - Board messages</li>
</ul>
<p><strong>Board Configuration (<code>&lt;name&gt;.yaml</code>):</strong></p>
<pre><code class="yaml"><span class="hl-9">name</span><span class="hl-1">: </span><span class="hl-10">general</span><br/><span class="hl-9">displayName</span><span class="hl-1">: </span><span class="hl-10">General</span><br/><span class="hl-9">description</span><span class="hl-1">: </span><span class="hl-10">General discussion</span><br/><span class="hl-9">permanent</span><span class="hl-1">: </span><span class="hl-4">false</span><span class="hl-1">          </span><span class="hl-8"># these messages expire</span><br/><span class="hl-9">expirationMs</span><span class="hl-1">: </span><span class="hl-14">2592000000</span><span class="hl-1">  </span><span class="hl-8"># Optional: milliseconds before messages expire (only used if permanent=false)</span><br/><span class="hl-9">writePermission</span><span class="hl-1">: </span><span class="hl-10">all</span><span class="hl-1">      </span><span class="hl-8"># &quot;all&quot; or &quot;admin&quot;</span><br/><span class="hl-9">nextMessageId</span><span class="hl-1">: </span><span class="hl-14">3</span><span class="hl-1">          </span><span class="hl-8"># Next ID to use for new messages</span>
</code><button type="button">Copy</button></pre>

<p><strong>Board Messages (<code>&lt;name&gt;.messages.yaml</code>):</strong></p>
<pre><code class="yaml"><span class="hl-9">messages</span><span class="hl-1">:</span><br/><span class="hl-1">  - </span><span class="hl-9">id</span><span class="hl-1">: </span><span class="hl-14">1</span><br/><span class="hl-1">    </span><span class="hl-9">author</span><span class="hl-1">: </span><span class="hl-10">username</span><br/><span class="hl-1">    </span><span class="hl-9">subject</span><span class="hl-1">: </span><span class="hl-10">Message subject</span><br/><span class="hl-1">    </span><span class="hl-9">content</span><span class="hl-1">: </span><span class="hl-3">&quot;Message content with</span><span class="hl-15">\r\n</span><span class="hl-3">multiple lines&quot;</span><br/><span class="hl-1">    </span><span class="hl-9">postedAt</span><span class="hl-1">: </span><span class="hl-3">&quot;2024-01-15T10:30:00.000Z&quot;</span><br/><span class="hl-1">    </span><span class="hl-9">targets</span><span class="hl-1">:              </span><span class="hl-8"># Optional: list of usernames, or omit for public messages</span><br/><span class="hl-1">      - </span><span class="hl-10">username1</span><br/><span class="hl-1">      - </span><span class="hl-10">username2</span><br/><span class="hl-1">    </span><span class="hl-9">readBy</span><span class="hl-1">:               </span><span class="hl-8"># Optional: list of character IDs who have read this message</span><br/><span class="hl-1">      - </span><span class="hl-14">1</span><br/><span class="hl-1">      - </span><span class="hl-14">5</span><br/><span class="hl-1">  - </span><span class="hl-9">id</span><span class="hl-1">: </span><span class="hl-14">2</span><br/><span class="hl-1">    </span><span class="hl-9">author</span><span class="hl-1">: </span><span class="hl-10">anotheruser</span><br/><span class="hl-1">    </span><span class="hl-9">subject</span><span class="hl-1">: </span><span class="hl-10">Another message</span><br/><span class="hl-1">    </span><span class="hl-9">content</span><span class="hl-1">: </span><span class="hl-3">&quot;Single line message&quot;</span><br/><span class="hl-1">    </span><span class="hl-9">postedAt</span><span class="hl-1">: </span><span class="hl-3">&quot;2024-01-15T11:00:00.000Z&quot;</span>
</code><button type="button">Copy</button></pre>

<p>The system automatically loads both files when a board is accessed. If the messages file is missing, the board will load with an empty message list.</p>
<h3 id="usage-3" class="tsd-anchor-link">Usage<a href="#usage-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">board</span><span class="hl-1">, { </span><span class="hl-2">saveBoard</span><span class="hl-1">, </span><span class="hl-2">loadBoard</span><span class="hl-1">, </span><span class="hl-2">getAllBoards</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/board.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">board</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">loaded</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadBoard</span><span class="hl-1">(</span><span class="hl-3">&quot;general&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">allBoards</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">getAllBoards</span><span class="hl-1">();</span><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">saveBoard</span><span class="hl-1">(</span><span class="hl-2">loadedBoard</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h2 id="5-character" class="tsd-anchor-link">5. character<a href="#5-character" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The character package provides character persistence with YAML storage, password authentication, active character registry, and serialization support. Characters are saved to <code>data/characters/&lt;username&gt;.yaml</code>.</p>
<h3 id="key-features-13" class="tsd-anchor-link">Key Features<a href="#key-features-13" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>YAML persistence</strong>: Characters serialized to YAML files</li>
<li><strong>Password authentication</strong>: Secure password hashing with SHA-256</li>
<li><strong>Active character registry</strong>: Prevents duplicate logins</li>
<li><strong>Character ID system</strong>: Unique IDs assigned to each character for tracking</li>
<li><strong>ID-based lookup</strong>: Fast O(1) lookup of active characters by ID</li>
<li><strong>Atomic writes</strong>: Uses temporary files and atomic rename to prevent corruption</li>
<li><strong>Serialization</strong>: Full serialization/deserialization support</li>
</ul>
<h3 id="usage-4" class="tsd-anchor-link">Usage<a href="#usage-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">character</span><span class="hl-1">, { </span><br/><span class="hl-1">  </span><span class="hl-2">saveCharacter</span><span class="hl-1">, </span><br/><span class="hl-1">  </span><span class="hl-2">loadCharacter</span><span class="hl-1">, </span><br/><span class="hl-1">  </span><span class="hl-2">checkCharacterPassword</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">getCharacterById</span><br/><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/character.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">character</span><span class="hl-1">);</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">saveCharacter</span><span class="hl-1">(</span><span class="hl-2">playerCharacter</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">serialized</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">checkCharacterPassword</span><span class="hl-1">(</span><span class="hl-3">&quot;username&quot;</span><span class="hl-1">, </span><span class="hl-3">&quot;password&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">serialized</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">char</span><span class="hl-1"> = </span><span class="hl-6">loadCharacterFromSerialized</span><span class="hl-1">(</span><span class="hl-2">serialized</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// Look up active character by ID</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">activeChar</span><span class="hl-1"> = </span><span class="hl-6">getCharacterById</span><span class="hl-1">(</span><span class="hl-2">characterId</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h2 id="6-commands" class="tsd-anchor-link">6. commands<a href="#6-commands" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The commands package provides a flexible command loading system that supports multiple formats: YAML files, JavaScript modules, and compiled TypeScript commands. Commands can be loaded from <code>data/commands</code> (runtime-extensible) or <code>dist/src/commands</code> (compiled built-in commands).</p>
<h3 id="key-features-14" class="tsd-anchor-link">Key Features<a href="#key-features-14" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Multiple formats</strong>: Supports YAML, JavaScript, and TypeScript commands</li>
<li><strong>Runtime extensibility</strong>: Add commands by creating files in <code>data/commands</code></li>
<li><strong>Built-in commands</strong>: Compiled TypeScript commands in <code>src/commands</code></li>
<li><strong>Automatic registration</strong>: Commands are automatically registered into <code>CommandRegistry.default</code></li>
<li><strong>File filtering</strong>: Files beginning with <code>_</code> are ignored</li>
</ul>
<h3 id="yaml-command-format" class="tsd-anchor-link">YAML Command Format<a href="#yaml-command-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="yaml"><span class="hl-8"># data/commands/greet.yaml</span><br/><span class="hl-9">pattern</span><span class="hl-1">: </span><span class="hl-10">greet &lt;target:character&gt;</span><br/><span class="hl-9">aliases</span><span class="hl-1">: [</span><span class="hl-10">hello &lt;target:character&gt;</span><span class="hl-1">]</span><br/><span class="hl-9">execute</span><span class="hl-1">: </span><span class="hl-0">|</span><br/><span class="hl-10">  function(context, args) {</span><br/><span class="hl-10">    const target = args.get(&quot;target&quot;);</span><br/><span class="hl-10">    context.actor.sendLine(`You greet ${target.display}!`);</span><br/><span class="hl-10">  }</span>
</code><button type="button">Copy</button></pre>

<h3 id="javascript-command-format" class="tsd-anchor-link">JavaScript Command Format<a href="#javascript-command-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-8">// data/commands/wave.js</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">pattern:</span><span class="hl-1"> </span><span class="hl-3">&quot;wave &lt;target:mob?&gt;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">execute</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">target</span><span class="hl-1"> = </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&quot;target&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">target</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">actor</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">`You wave at </span><span class="hl-4">${</span><span class="hl-2">target</span><span class="hl-11">.</span><span class="hl-2">display</span><span class="hl-4">}</span><span class="hl-3">.`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">actor</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">&quot;You wave.&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<h3 id="typescript-command-format" class="tsd-anchor-link">TypeScript Command Format<a href="#typescript-command-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-8">// src/commands/say.ts</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Command</span><span class="hl-1">, </span><span class="hl-2">CommandContext</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;../command.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-5">SayCommand</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-5">Command</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">pattern</span><span class="hl-1"> = </span><span class="hl-3">&quot;say &lt;message:text&gt;&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-6">execute</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">: </span><span class="hl-5">CommandContext</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">: </span><span class="hl-5">Map</span><span class="hl-1">&lt;</span><span class="hl-5">string</span><span class="hl-1">, </span><span class="hl-5">any</span><span class="hl-1">&gt;) {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">message</span><span class="hl-1"> = </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-3">&quot;message&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">actor</span><span class="hl-1">.</span><span class="hl-6">sendLine</span><span class="hl-1">(</span><span class="hl-3">`You say: </span><span class="hl-4">${</span><span class="hl-2">message</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="usage-5" class="tsd-anchor-link">Usage<a href="#usage-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">commands</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/commands.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">commands</span><span class="hl-1">);</span><br/><span class="hl-8">// All commands from data/commands and src/commands are now registered</span>
</code><button type="button">Copy</button></pre>

<h2 id="gamestate" class="tsd-anchor-link">gamestate<a href="#gamestate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The gamestate package provides runtime state persistence for tracking elapsed game time and character ID generation across server restarts. It automatically calculates downtime and adds it to elapsed time, ensuring continuity even after server restarts.</p>
<h3 id="key-features-15" class="tsd-anchor-link">Key Features<a href="#key-features-15" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Elapsed time tracking</strong>: Tracks total game time in milliseconds</li>
<li><strong>Downtime calculation</strong>: Automatically calculates and adds server downtime to elapsed time</li>
<li><strong>Character ID generation</strong>: Manages next character ID counter for unique character identification</li>
<li><strong>Atomic writes</strong>: Uses temporary files and atomic rename to prevent corruption</li>
<li><strong>Default state</strong>: Creates default gamestate file if missing</li>
<li><strong>Session tracking</strong>: Tracks time in current session separately from persisted time</li>
</ul>
<h3 id="usage-6" class="tsd-anchor-link">Usage<a href="#usage-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">gamestate</span><span class="hl-1">, { </span><span class="hl-2">getElapsedTime</span><span class="hl-1">, </span><span class="hl-2">saveGameState</span><span class="hl-1">, </span><span class="hl-2">getNextCharacterId</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./src/package/gamestate.js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPackage</span><span class="hl-1">(</span><span class="hl-2">gamestate</span><span class="hl-1">);</span><br/><br/><span class="hl-8">// Get total elapsed time (includes previous sessions + downtime)</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">elapsed</span><span class="hl-1"> = </span><span class="hl-6">getElapsedTime</span><span class="hl-1">(); </span><span class="hl-8">// milliseconds</span><br/><br/><span class="hl-8">// Get next character ID (increments counter and saves)</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">nextId</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">getNextCharacterId</span><span class="hl-1">();</span><br/><br/><span class="hl-8">// Save state (called automatically every 5 minutes)</span><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">saveGameState</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<h3 id="game-state-structure" class="tsd-anchor-link">Game State Structure<a href="#game-state-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="yaml"><span class="hl-9">elapsedTime</span><span class="hl-1">: </span><span class="hl-14">1234567890</span><br/><span class="hl-9">lastSaved</span><span class="hl-1">: </span><span class="hl-3">&quot;2024-01-15T10:30:00.000Z&quot;</span><br/><span class="hl-9">nextCharacterId</span><span class="hl-1">: </span><span class="hl-14">42</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#mud3"><span>mud3</span></a><a href="#features"><span>Features</span></a><ul><li><a href="#1-efficient-and-user-accessible-command-pattern-system"><span>1. <wbr/>Efficient and user-<wbr/>accessible command pattern system</span></a></li><li><ul><li><a href="#key-features"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#2-expandable-channel-system"><span>2. <wbr/>Expandable channel system</span></a></li><li><ul><li><a href="#key-features-1"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples-1"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#3-easy-to-use-message-board-system"><span>3. <wbr/>Easy-<wbr/>to-<wbr/>use message board system</span></a></li><li><ul><li><a href="#key-features-2"><span>Key <wbr/>Features</span></a></li><li><a href="#targetable-messages"><span>Targetable <wbr/>Messages</span></a></li><li><a href="#writing-interface"><span>Writing <wbr/>Interface</span></a></li><li><a href="#read-tracking-using-character-ids"><span>Read <wbr/>Tracking <wbr/>Using <wbr/>Character <wbr/>I<wbr/>Ds</span></a></li><li><a href="#reading-the-oldest-unread-message"><span>Reading the <wbr/>Oldest <wbr/>Unread <wbr/>Message</span></a></li><li><a href="#login-unread-message-notifications"><span>Login <wbr/>Unread <wbr/>Message <wbr/>Notifications</span></a></li><li><a href="#targeted-message-notifications"><span>Targeted <wbr/>Message <wbr/>Notifications</span></a></li><li><a href="#board-yaml-format"><span>Board <wbr/>YAML <wbr/>Format</span></a></li></ul></li><li><a href="#4-dungeon-and-dungeonobject-and-room-systems"><span>4. <wbr/>Dungeon and <wbr/>Dungeon<wbr/>Object and <wbr/>Room systems</span></a></li><li><ul><li><a href="#key-features-3"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples-2"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#5-the-dungeon-registry-system"><span>5. <wbr/>The dungeon registry system</span></a></li><li><ul><li><a href="#key-features-4"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples-3"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#6-the-room-link-system"><span>6. <wbr/>The <wbr/>Room <wbr/>Link system</span></a></li><li><ul><li><a href="#key-features-5"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples-4"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#7-the-room-ref-system"><span>7. <wbr/>The room ref system</span></a></li><li><ul><li><a href="#key-features-6"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples-5"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#8-the-simple-client-and-server-system"><span>8. <wbr/>The simple client and server system</span></a></li><li><ul><li><a href="#key-features-7"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-examples-6"><span>Usage <wbr/>Examples</span></a></li></ul></li><li><a href="#9-the-color-system"><span>9. <wbr/>The color system</span></a></li><li><ul><li><a href="#key-features-8"><span>Key <wbr/>Features</span></a></li><li><a href="#color-codes"><span>Color <wbr/>Codes</span></a></li><li><a href="#usage-examples-7"><span>Usage <wbr/>Examples</span></a></li></ul></li></ul><a href="#packages"><span>Packages</span></a><ul><li><a href="#lockfile"><span>lockfile</span></a></li><li><ul><li><a href="#key-features-9"><span>Key <wbr/>Features</span></a></li><li><a href="#usage"><span>Usage</span></a></li></ul></li><li><a href="#config"><span>config</span></a></li><li><ul><li><a href="#key-features-10"><span>Key <wbr/>Features</span></a></li><li><a href="#configuration-structure"><span>Configuration <wbr/>Structure</span></a></li><li><a href="#usage-1"><span>Usage</span></a></li></ul></li><li><a href="#help"><span>help</span></a></li><li><ul><li><a href="#key-features-11"><span>Key <wbr/>Features</span></a></li><li><a href="#help-file-format"><span>Help <wbr/>File <wbr/>Format</span></a></li><li><a href="#usage-2"><span>Usage</span></a></li></ul></li><li><a href="#board"><span>board</span></a></li><li><ul><li><a href="#key-features-12"><span>Key <wbr/>Features</span></a></li><li><a href="#board-yaml-format-1"><span>Board <wbr/>YAML <wbr/>Format</span></a></li><li><a href="#usage-3"><span>Usage</span></a></li></ul></li><li><a href="#5-character"><span>5. character</span></a></li><li><ul><li><a href="#key-features-13"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-4"><span>Usage</span></a></li></ul></li><li><a href="#6-commands"><span>6. commands</span></a></li><li><ul><li><a href="#key-features-14"><span>Key <wbr/>Features</span></a></li><li><a href="#yaml-command-format"><span>YAML <wbr/>Command <wbr/>Format</span></a></li><li><a href="#javascript-command-format"><span>Java<wbr/>Script <wbr/>Command <wbr/>Format</span></a></li><li><a href="#typescript-command-format"><span>Type<wbr/>Script <wbr/>Command <wbr/>Format</span></a></li><li><a href="#usage-5"><span>Usage</span></a></li></ul></li><li><a href="#gamestate"><span>gamestate</span></a></li><li><ul><li><a href="#key-features-15"><span>Key <wbr/>Features</span></a></li><li><a href="#usage-6"><span>Usage</span></a></li><li><a href="#game-state-structure"><span>Game <wbr/>State <wbr/>Structure</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">mud3</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
